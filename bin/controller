#!/usr/bin/env ruby
# encoding: UTF-8

require "optparse"

require "deep-connect/deep-connect"

require "share/conf"
require "controller"

Thread.abort_on_exception = Fairy::CONF.DEBUG_THREAD_ABORT_ON_EXCEPTION

if Fairy::CONF.USE_RESOLV_REPLACE
  require "resolv-replace"
end

master_port = Fairy::CONF.MASTER_PORT
id = nil
opt = OptionParser.new do |opt|
  opt.on("--master=VAL"){|val| master_port = val}
  opt.on("--id=VAL"){|val| id = val}
end
opt.parse!(ARGV)

Fairy::Controller.start(id.to_i, master_port)

sleep
